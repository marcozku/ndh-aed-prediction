{
  "timeline": [
    {
      "version": "2.9.20",
      "date": "2025-12-30",
      "description": "基礎 XGBoost 模型",
      "changes": ["300 棵樹", "深度 6", "52 特徵"],
      "metrics": {
        "mae": 3.84,
        "mape": 1.56,
        "rmse": 5.71,
        "r2": 0.59,
        "feature_count": 52
      }
    },
    {
      "version": "2.9.24",
      "date": "2025-12-31",
      "description": "天氣特徵整合",
      "changes": ["新增 HKO 歷史天氣數據", "10 個天氣特徵", "37 年歷史數據"],
      "metrics": {
        "mae": 3.75,
        "mape": 1.52,
        "rmse": 5.60,
        "r2": 0.62,
        "feature_count": 89
      },
      "research": "BMC Medical Informatics (2024)"
    },
    {
      "version": "2.9.28",
      "date": "2026-01-02",
      "description": "研究基礎優化",
      "changes": [
        "超參數優化 (500樹, 深度8)",
        "樣本權重 (時間衰減+COVID調整)",
        "Fourier 季節特徵 (10個)"
      ],
      "metrics": {
        "mae": 3.84,
        "mape": 1.56,
        "rmse": 5.71,
        "r2": 0.59,
        "feature_count": 99
      },
      "research": "BMC EM (2025), JMIR (2025), Prophet"
    },
    {
      "version": "2.9.50",
      "date": "2026-01-01",
      "description": "Optuna 超參數優化 + 擴展特徵工程",
      "changes": [
        "Optuna TPE 自動調參 (15 trials)",
        "擴展滯後特徵 (Lag1-7, Lag14-365)",
        "同星期歷史滯後 (1w-4w)",
        "EWMA 指數加權移動平均",
        "目標編碼特徵 (DayOfWeek, Month, YearMonth)",
        "相對位置特徵 + 變異係數",
        "擴展滾動統計 (3-90天窗口)"
      ],
      "metrics": {
        "mae": 6.30,
        "mape": 2.45,
        "rmse": 8.20,
        "r2": 0.90,
        "adj_r2": 0.87,
        "feature_count": 161
      },
      "research": "Optuna (Akiba et al., 2019)",
      "key_features": ["EWMA14 (48%)", "EWMA7 (33%)", "EWMA30 (4%)"],
      "improvement": "R² 從 59% 提升到 90.3%"
    },
    {
      "version": "2.9.52",
      "date": "2026-01-02",
      "description": "自動特徵優化系統",
      "changes": [
        "特徵數從 161 優化到 25 個精選特徵",
        "EWMA7+EWMA14 佔 90% 重要性",
        "移除冗餘特徵，提升泛化能力",
        "訓練速度提升 85%",
        "默認使用優化特徵集"
      ],
      "metrics": {
        "mae": 4.73,
        "mape": 1.87,
        "rmse": 6.84,
        "r2": 0.933,
        "adj_r2": 0.930,
        "feature_count": 25
      },
      "research": "特徵選擇研究: 維度災難 (Curse of Dimensionality)",
      "key_features": ["EWMA7 (45%)", "EWMA14 (45%)", "Daily_Change (2%)"],
      "improvement": "MAE↓25%, R²↑3%, 訓練時間↓85%"
    },
    {
      "version": "2.9.52",
      "date": "2026-01-02",
      "description": "自動特徵優化系統",
      "changes": [
        "創建 auto_feature_optimizer.py 智能優化器",
        "多種特徵選擇算法（RFE、重要性、相關性、混合）",
        "API 端點：POST /api/optimize-features",
        "動態加載最佳特徵配置",
        "訓練整合：--optimize 參數"
      ],
      "metrics": {
        "mae": 5.33,
        "mape": 2.10,
        "r2": 0.92,
        "adj_r2": 0.917,
        "feature_count": 25
      },
      "research": "維度災難研究、特徵選擇最佳實踐",
      "key_features": ["EWMA7 (87%)", "自動優化", "持續學習"],
      "improvement": "自動尋找最佳特徵組合，持續優化"
    },
    {
      "version": "3.0.10",
      "date": "2026-01-02",
      "description": "天氣警告特徵 + 文檔自動化",
      "changes": [
        "新增 11 個天氣特徵（颱風/暴雨/警告）",
        "Weather_Temp_Change, Typhoon_Signal 等",
        "訓練後自動更新特徵文檔",
        "CURRENT_FEATURES.md 自動生成"
      ],
      "metrics": {
        "mae": 4.01,
        "mape": 1.59,
        "rmse": 5.45,
        "r2": 0.958,
        "adj_r2": 0.957,
        "feature_count": 25
      },
      "research": "極端天氣對急診影響研究 (HKMJ 2020, Disaster Medicine 2018)",
      "key_features": ["颱風信號", "暴雨警告", "酷熱/寒冷警告"],
      "improvement": "整合香港極端天氣事件特徵"
    },
    {
      "version": "3.0.13",
      "date": "2026-01-02",
      "description": "天氣影響分析圖表重構",
      "changes": [
        "「影響力偏差圖」取代舊圖表",
        "所有天氣因素一覽，按影響力排序",
        "紅色=增加出席，藍色=減少出席",
        "倒計時修復：永不顯示「計算中」"
      ],
      "metrics": {
        "mae": 4.01,
        "mape": 1.59,
        "rmse": 5.45,
        "r2": 0.958,
        "adj_r2": 0.957,
        "feature_count": 25
      },
      "improvement": "更清晰的天氣影響可視化"
    },
    {
      "version": "3.0.38",
      "date": "2026-01-04",
      "description": "Pragmatic Bayesian 融合",
      "changes": [
        "Bayesian 精度加權融合（XGBoost+AI+天氣）",
        "極端值自動降權機制",
        "可靠度從歷史數據自動學習"
      ],
      "metrics": {
        "mae": 4.01,
        "mape": 1.59,
        "rmse": 5.45,
        "r2": 0.958,
        "adj_r2": 0.957,
        "feature_count": 25
      },
      "research": "Bayesian Model Averaging, Kalman Filter",
      "improvement": "多來源智能融合，避免單一來源偏差"
    },
    {
      "version": "3.0.50",
      "date": "2026-01-03",
      "description": "加法效應模型 + Post-COVID 校準",
      "changes": [
        "改用加法效應模型（避免乘法疊加過高）",
        "Post-COVID 2023-2025 數據校準（週一270，均值254）",
        "硬上限控制（180-320，今日340）",
        "遠期預測趨勢衰減（回歸均值）"
      ],
      "metrics": {
        "mae": 4.01,
        "mape": 1.59,
        "rmse": 5.45,
        "r2": 0.958,
        "adj_r2": 0.957,
        "feature_count": 25,
        "note": "模型指標不變，預測邏輯優化"
      },
      "research": "Facebook Prophet 趨勢分解, BMC EM (2025)",
      "key_features": ["加法效應", "硬上限控制", "趨勢衰減"],
      "improvement": "預測值限制在歷史合理範圍（180-320）"
    },
    {
      "version": "3.0.60",
      "date": "2026-01-03",
      "description": "天氣警告數據擴展 + 真實影響分析",
      "changes": [
        "擴展天氣警告數據 (34天 → 1869天)",
        "真實數據分析各警告類型影響",
        "颱風/暴雨/酷熱/寒冷警告特徵",
        "UI 圖表顯示真實統計數據"
      ],
      "metrics": {
        "mae": 4.01,
        "mape": 1.59,
        "rmse": 5.45,
        "r2": 0.958,
        "adj_r2": 0.957,
        "feature_count": 25,
        "weather_features": 8,
        "note": "等待重新訓練以整合新天氣特徵"
      },
      "research": "NDH AED 真實數據分析, HKO 歷史警告",
      "key_features": ["Typhoon_Signal", "Rainstorm_Warning", "Hot_Warning", "Cold_Warning"],
      "data_analysis": {
        "baseline": "無警告日 251.3 人",
        "T8_impact": "-12.1%",
        "black_rain_impact": "-8.0%",
        "sample_size": "3429 天"
      },
      "improvement": "基於真實數據的天氣影響量化"
    },
    {
      "version": "3.0.61",
      "date": "2026-01-03",
      "description": "自動天氣影響分析整合",
      "changes": [
        "數據上傳後自動運行天氣影響分析",
        "新增 API 端點 (/api/analyze-weather-impact, /api/weather-impact)",
        "模型訓練前自動更新天氣因子",
        "非阻塞異步執行，不影響主流程"
      ],
      "metrics": {
        "mae": 4.01,
        "mape": 1.59,
        "rmse": 5.45,
        "r2": 0.958,
        "adj_r2": 0.957,
        "feature_count": 25,
        "weather_features": 8,
        "note": "架構改進，等待新數據測試"
      },
      "automation": {
        "csv_import": "自動觸發",
        "bulk_upload": "自動觸發",
        "before_training": "自動運行",
        "script": "python/auto_weather_analysis.py",
        "output": "python/models/weather_impact_analysis.json"
      },
      "improvement": "數據驅動的自動化分析流程"
    },
    {
      "version": "3.0.70",
      "date": "2026-01-04",
      "description": "AI 因子去重機制",
      "changes": [
        "修改 AI Prompt 避免重複計算天氣/假期/季節因素",
        "AI 專注分析：健康政策、突發事件、醫院公告",
        "系統自動處理：天氣、假期、流感季、週末",
        "更新演算法文檔說明因子分工"
      ],
      "metrics": {
        "mae": 4.01,
        "mape": 1.59,
        "rmse": 5.45,
        "r2": 0.958,
        "feature_count": 25,
        "note": "邏輯優化，避免因子重複加權"
      },
      "research": "因子正交化、避免多重共線性",
      "improvement": "AI 與系統因子不再重複，預測更穩定"
    },
    {
      "version": "3.0.73",
      "date": "2026-01-04",
      "description": "AQHI 空氣質素整合",
      "changes": [
        "新增 EPD AQHI 歷史數據 (2013-2026，4000+ 天)",
        "5 個 AQHI 特徵：General/Roadside Avg/Max、Risk Level",
        "實時 AQHI 顯示與天氣一併展示",
        "AI 新增分析：體育/文娛活動、學校日曆、傳染病爆發",
        "iOS Safari PWA 自動更新機制改進"
      ],
      "metrics": {
        "mae": 5.22,
        "mape": 2.05,
        "rmse": 7.23,
        "r2": 0.925,
        "feature_count": 27,
        "aqhi_features": 2,
        "note": "AQHI 數據覆蓋 587/3438 天，隨數據累積效果會提升"
      },
      "research": "空氣污染與呼吸道/心血管急症研究 (Lancet 2019)",
      "key_features": ["AQHI_General_Max", "AQHI_Roadside_Max", "AQHI_Risk"],
      "data_source": "環保署 AQHI API (aqhi.gov.hk)",
      "improvement": "預期：高 AQHI 日可提升預測準確度 5-10%"
    },
    {
      "version": "3.0.74",
      "date": "2026-01-04",
      "description": "完整 HKO 天氣因素分析整合",
      "changes": [
        "下載 HKO JSON 天氣數據 (2014-2025，4383 天)",
        "新增 11 個天氣變量：氣壓、濕度、降雨、風速、能見度等",
        "統計相關性分析 (Pearson r, t-test)",
        "發現顯著因素：寒冷(-6.8%)、大雨(-4.9%)、強風(-2.8%)",
        "40 個優化特徵集 (含新天氣極端條件特徵)"
      ],
      "metrics": {
        "mae": 6.08,
        "mape": 2.38,
        "rmse": 8.35,
        "r2": 0.900,
        "feature_count": 40,
        "weather_features": 11,
        "note": "新天氣特徵相關性較弱(r<0.12)，主要在極端條件下有效"
      },
      "research": "HKO Daily Extract API, Pearson 相關性分析",
      "correlations": [
        {"factor": "Visibility", "r": 0.1196, "p": "<0.001"},
        {"factor": "Wind", "r": -0.1058, "p": "<0.001"},
        {"factor": "DewPoint", "r": 0.0932, "p": "<0.001"},
        {"factor": "Temp_Min", "r": 0.0820, "p": "<0.001"},
        {"factor": "Humidity", "r": 0.0789, "p": "<0.001"}
      ],
      "extreme_conditions": [
        {"condition": "Cold (Min<12C)", "impact": "-6.8%", "n": 128, "p": "<0.001"},
        {"condition": "Heavy Rain (>25mm)", "impact": "-4.9%", "n": 232, "p": "<0.001"},
        {"condition": "Low Humidity (<50%)", "impact": "-4.7%", "n": 94, "p": "0.011"},
        {"condition": "Strong Wind (>30km/h)", "impact": "-2.8%", "n": 789, "p": "<0.001"},
        {"condition": "Hot (Max>30C)", "impact": "+1.2%", "n": 1064, "p": "0.007"}
      ],
      "data_source": "HKO Daily Extract JSON API (2014-2025)",
      "improvement": "完整天氣因素量化分析，極端天氣預測更準確"
    },
    {
      "version": "3.0.75",
      "date": "2026-01-04",
      "description": "RFE 特徵優化 (25 特徵)",
      "changes": [
        "使用遞歸特徵消除 (RFE) 選擇最佳 25 個特徵",
        "EWMA7 佔 87% 重要性，主導預測",
        "天氣/AQHI 特徵因弱相關性被排除",
        "研究分析：EWMA 已隱式捕獲天氣影響"
      ],
      "metrics": {
        "mae": 3.36,
        "mape": 1.36,
        "rmse": 4.85,
        "r2": 0.964,
        "feature_count": 25,
        "note": "RFE 優化器測試 MAE=3.36，生產測試 MAE≈6.18"
      },
      "research": "Recursive Feature Elimination, Concept Drift 分析",
      "key_features": ["EWMA7 (87%)", "Monthly_Change (2.8%)", "Daily_Change (2.3%)"],
      "excluded_features": ["AQHI_*", "Weather_*", "天氣因素因弱相關被排除"],
      "improvement": "模型精簡化，避免過擬合，提高可解釋性"
    },
    {
      "version": "3.0.76",
      "date": "2026-01-04",
      "description": "Concept Drift 解決方案 + 極端條件後處理",
      "changes": [
        "新增滑動窗口訓練 (--sliding-window N)",
        "新增時間衰減權重 (--time-decay 0.001)",
        "極端條件後處理調整層 (prediction.js)",
        "AQHI>=7: +2.5%, AQHI>=10: +5%",
        "極寒<8°C: -3%, 暴雨>25mm: -5%, 強風>30km/h: -3%"
      ],
      "metrics": {
        "mae": 6.18,
        "mape": 2.42,
        "r2": 0.898,
        "feature_count": 25,
        "note": "預計使用滑動窗口(2年)可將 MAE 降至 ~4.0"
      },
      "architecture": {
        "layer1": "XGBoost 預測 (25 核心特徵)",
        "layer2": "Bayesian 融合 (AI + Weather)",
        "layer3": "極端條件後處理調整"
      },
      "training_options": {
        "sliding_window": "只用最近 N 年數據",
        "time_decay": "近期數據權重更高",
        "recommended": "--sliding-window 2 --time-decay 0.001"
      },
      "research": "Concept Drift in Time Series (Gama et al., 2014)",
      "improvement": "解決 2020 COVID 後模式變化問題，提升近期預測準確性"
    }
  ],
  "last_updated": "2026-01-04T16:00:00+08:00"
}
