/**
 * å°å…¥æ­·å²æ•¸æ“šè…³æœ¬
 * å°‡2015-2024å¹´çš„æ­·å²æ•¸æ“šå°å…¥PostgreSQLæ•¸æ“šåº«
 */

const db = require('./database');

// å¾ç”¨æˆ¶æä¾›çš„CSVæ•¸æ“šè§£æ
const CSV_DATA = `Date,Attendance,DayOfWeek,IsWeekend
2015-12-03,271,Thursday,False
2015-12-04,270,Friday,False
2015-12-05,254,Saturday,True
2015-12-06,246,Sunday,True
2015-12-07,273,Monday,False
2015-12-08,282,Tuesday,False
2015-12-09,225,Wednesday,False
2015-12-10,288,Thursday,False
2015-12-11,264,Friday,False
2015-12-12,251,Saturday,True
2015-12-13,282,Sunday,True
2015-12-14,332,Monday,False
2015-12-15,270,Tuesday,False
2015-12-16,247,Wednesday,False
2015-12-17,297,Thursday,False
2015-12-18,290,Friday,False
2015-12-19,250,Saturday,True
2015-12-20,214,Sunday,True
2015-12-21,295,Monday,False
2015-12-22,301,Tuesday,False
2015-12-23,260,Wednesday,False
2015-12-24,307,Thursday,False
2015-12-25,259,Friday,False
2015-12-26,279,Saturday,True
2015-12-27,279,Sunday,True
2015-12-28,291,Monday,False
2015-12-29,299,Tuesday,False
2015-12-30,275,Wednesday,False
2015-12-31,252,Thursday,False
2016-01-01,264,Friday,False
2016-01-02,283,Saturday,True
2016-01-03,266,Sunday,True
2016-01-04,360,Monday,False
2016-01-05,273,Tuesday,False
2016-01-06,313,Wednesday,False
2016-01-07,296,Thursday,False
2016-01-08,286,Friday,False
2016-01-09,282,Saturday,True
2016-01-10,290,Sunday,True
2016-01-11,279,Monday,False
2016-01-12,264,Tuesday,False
2016-01-13,306,Wednesday,False
2016-01-14,260,Thursday,False
2016-01-15,260,Friday,False
2016-01-16,258,Saturday,True
2016-01-17,256,Sunday,True
2016-01-18,330,Monday,False
2016-01-19,283,Tuesday,False
2016-01-20,295,Wednesday,False
2016-01-21,296,Thursday,False
2016-01-22,241,Friday,False
2016-01-23,227,Saturday,True
2016-01-24,225,Sunday,True
2016-01-25,297,Monday,False
2016-01-26,305,Tuesday,False
2016-01-27,323,Wednesday,False
2016-01-28,306,Thursday,False
2016-01-29,315,Friday,False
2016-01-30,325,Saturday,True
2016-01-31,303,Sunday,True
2016-02-01,300,Monday,False
2016-02-02,303,Tuesday,False
2016-02-03,297,Wednesday,False
2016-02-04,299,Thursday,False
2016-02-05,286,Friday,False
2016-02-06,278,Saturday,True
2016-02-07,282,Sunday,True
2016-02-08,326,Monday,False
2016-02-09,394,Tuesday,False
2016-02-10,389,Wednesday,False
2016-02-11,379,Thursday,False
2016-02-12,351,Friday,False
2016-02-13,311,Saturday,True
2016-02-14,322,Sunday,True
2017-12-03,268,Sunday,True
2017-12-04,288,Monday,False
2017-12-05,273,Tuesday,False
2017-12-06,285,Wednesday,False
2017-12-07,299,Thursday,False
2017-12-08,280,Friday,False
2017-12-09,240,Saturday,True
2017-12-10,296,Sunday,True
2017-12-11,303,Monday,False
2017-12-12,315,Tuesday,False
2017-12-13,265,Wednesday,False
2017-12-14,319,Thursday,False
2017-12-15,270,Friday,False
2017-12-16,234,Saturday,True
2017-12-17,259,Sunday,True
2017-12-18,313,Monday,False
2017-12-19,256,Tuesday,False
2017-12-20,274,Wednesday,False
2017-12-21,235,Thursday,False
2017-12-22,258,Friday,False
2017-12-23,304,Saturday,True
2017-12-24,280,Sunday,True
2017-12-25,269,Monday,False
2017-12-26,298,Tuesday,False
2017-12-27,274,Wednesday,False
2017-12-28,301,Thursday,False
2017-12-29,272,Friday,False
2017-12-30,307,Saturday,True
2017-12-31,267,Sunday,True
2018-01-01,274,Monday,False
2018-01-02,338,Tuesday,False
2018-01-03,287,Wednesday,False
2018-01-04,307,Thursday,False
2018-01-05,273,Friday,False
2018-01-06,256,Saturday,True
2018-01-07,241,Sunday,True
2018-01-08,270,Monday,False
2018-01-09,221,Tuesday,False
2018-01-10,255,Wednesday,False
2018-01-11,263,Thursday,False
2018-01-12,266,Friday,False
2018-01-13,253,Saturday,True
2018-01-14,267,Sunday,True
2018-01-15,325,Monday,False
2018-01-16,285,Tuesday,False
2018-01-17,289,Wednesday,False
2018-01-18,308,Thursday,False
2018-01-19,294,Friday,False
2018-01-20,254,Saturday,True
2018-01-21,286,Sunday,True
2018-01-22,332,Monday,False
2018-01-23,320,Tuesday,False
2018-01-24,284,Wednesday,False
2018-01-25,265,Thursday,False
2018-01-26,298,Friday,False
2018-01-27,284,Saturday,True
2018-01-28,252,Sunday,True
2018-01-29,296,Monday,False
2018-01-30,262,Tuesday,False
2018-01-31,238,Wednesday,False
2018-02-01,217,Thursday,False
2018-02-02,234,Friday,False
2018-02-03,227,Saturday,True
2018-02-04,248,Sunday,True
2018-02-05,302,Monday,False
2018-02-06,298,Tuesday,False
2018-02-07,305,Wednesday,False
2018-02-08,278,Thursday,False
2018-02-09,271,Friday,False
2018-02-10,284,Saturday,True
2018-02-11,267,Sunday,True
2018-02-12,271,Monday,False
2018-02-13,292,Tuesday,False
2018-02-14,228,Wednesday,False
2018-12-03,323,Monday,False
2018-12-04,284,Tuesday,False
2018-12-05,303,Wednesday,False
2018-12-06,269,Thursday,False
2018-12-07,299,Friday,False
2018-12-08,228,Saturday,True
2018-12-09,229,Sunday,True
2018-12-10,275,Monday,False
2018-12-11,242,Tuesday,False
2018-12-12,246,Wednesday,False
2018-12-13,245,Thursday,False
2018-12-14,238,Friday,False
2018-12-15,241,Saturday,True
2018-12-16,272,Sunday,True
2018-12-17,251,Monday,False
2018-12-18,267,Tuesday,False
2018-12-19,256,Wednesday,False
2018-12-20,315,Thursday,False
2018-12-21,260,Friday,False
2018-12-22,260,Saturday,True
2018-12-23,275,Sunday,True
2018-12-24,266,Monday,False
2018-12-25,244,Tuesday,False
2018-12-26,260,Wednesday,False
2018-12-27,301,Thursday,False
2018-12-28,238,Friday,False
2018-12-29,213,Saturday,True
2018-12-30,231,Sunday,True
2018-12-31,245,Monday,False
2019-01-01,259,Tuesday,False
2019-01-02,265,Wednesday,False
2019-01-03,270,Thursday,False
2019-01-04,281,Friday,False
2019-01-05,300,Saturday,True
2019-01-06,281,Sunday,True
2019-01-07,308,Monday,False
2019-01-08,283,Tuesday,False
2019-01-09,266,Wednesday,False
2019-01-10,305,Thursday,False
2019-01-11,304,Friday,False
2019-01-12,244,Saturday,True
2019-01-13,269,Sunday,True
2019-01-14,317,Monday,False
2019-01-15,285,Tuesday,False
2019-01-16,260,Wednesday,False
2019-01-17,253,Thursday,False
2019-01-18,295,Friday,False
2019-01-19,241,Saturday,True
2019-01-20,280,Sunday,True
2019-01-21,288,Monday,False
2019-01-22,249,Tuesday,False
2019-01-23,256,Wednesday,False
2019-01-24,249,Thursday,False
2019-01-25,257,Friday,False
2019-01-26,262,Saturday,True
2019-01-27,227,Sunday,True
2019-01-28,285,Monday,False
2019-01-29,238,Tuesday,False
2019-01-30,245,Wednesday,False
2019-01-31,246,Thursday,False
2019-02-01,245,Friday,False
2019-02-02,233,Saturday,True
2019-02-03,247,Sunday,True
2019-02-04,216,Monday,False
2019-02-05,199,Tuesday,False
2019-02-06,270,Wednesday,False
2019-02-07,242,Thursday,False
2019-02-08,265,Friday,False
2019-02-09,273,Saturday,True
2019-02-10,214,Sunday,True
2019-02-11,259,Monday,False
2019-02-12,241,Tuesday,False
2019-02-13,268,Wednesday,False
2019-02-14,236,Thursday,False
2019-12-03,248,Tuesday,False
2019-12-04,230,Wednesday,False
2019-12-05,228,Thursday,False
2019-12-06,256,Friday,False
2019-12-07,224,Saturday,True
2019-12-08,216,Sunday,True
2019-12-09,256,Monday,False
2019-12-10,238,Tuesday,False
2019-12-11,242,Wednesday,False
2019-12-12,251,Thursday,False
2019-12-13,268,Friday,False
2019-12-14,231,Saturday,True
2019-12-15,249,Sunday,True
2019-12-16,294,Monday,False
2019-12-17,281,Tuesday,False
2019-12-18,257,Wednesday,False
2019-12-19,271,Thursday,False
2019-12-20,264,Friday,False
2019-12-21,234,Saturday,True
2019-12-22,238,Sunday,True
2019-12-23,290,Monday,False
2019-12-24,256,Tuesday,False
2019-12-25,247,Wednesday,False
2019-12-26,219,Thursday,False
2019-12-27,278,Friday,False
2019-12-28,228,Saturday,True
2019-12-29,260,Sunday,True
2019-12-30,284,Monday,False
2019-12-31,262,Tuesday,False
2020-01-01,233,Wednesday,False
2020-01-02,273,Thursday,False
2020-01-03,265,Friday,False
2020-01-04,248,Saturday,True
2020-01-05,276,Sunday,True
2020-01-06,297,Monday,False
2020-01-07,289,Tuesday,False
2020-01-08,288,Wednesday,False
2020-01-09,258,Thursday,False
2020-01-10,288,Friday,False
2020-01-11,241,Saturday,True
2020-01-12,243,Sunday,True
2020-01-13,289,Monday,False
2020-01-14,258,Tuesday,False
2020-01-15,240,Wednesday,False
2020-01-16,267,Thursday,False
2020-01-17,253,Friday,False
2020-01-18,226,Saturday,True
2020-01-19,243,Sunday,True
2020-01-20,277,Monday,False
2020-01-21,241,Tuesday,False
2020-01-22,238,Wednesday,False
2020-01-23,283,Thursday,False
2020-01-24,223,Friday,False
2020-01-25,212,Saturday,True
2020-01-26,191,Sunday,True
2020-01-27,166,Monday,False
2020-01-28,158,Tuesday,False
2020-01-29,195,Wednesday,False
2020-01-30,179,Thursday,False
2020-01-31,183,Friday,False
2020-02-01,179,Saturday,True
2020-02-02,186,Sunday,True
2020-02-03,178,Monday,False
2020-02-04,136,Tuesday,False
2020-02-05,161,Wednesday,False
2020-02-06,147,Thursday,False
2020-02-07,157,Friday,False
2020-02-08,111,Saturday,True
2020-02-09,141,Sunday,True
2020-02-10,169,Monday,False
2020-02-11,147,Tuesday,False
2020-02-12,166,Wednesday,False
2020-02-13,152,Thursday,False
2020-02-14,163,Friday,False
2020-12-03,181,Thursday,False
2020-12-04,191,Friday,False
2020-12-05,150,Saturday,True
2020-12-06,156,Sunday,True
2020-12-07,185,Monday,False
2020-12-08,186,Tuesday,False
2020-12-09,190,Wednesday,False
2020-12-10,189,Thursday,False
2020-12-11,166,Friday,False
2020-12-12,156,Saturday,True
2020-12-13,164,Sunday,True
2020-12-14,186,Monday,False
2020-12-15,164,Tuesday,False
2020-12-16,155,Wednesday,False
2020-12-17,185,Thursday,False
2020-12-18,156,Friday,False
2020-12-19,161,Saturday,True
2020-12-20,139,Sunday,True
2020-12-21,164,Monday,False
2020-12-22,178,Tuesday,False
2020-12-23,188,Wednesday,False
2020-12-24,177,Thursday,False
2020-12-25,168,Friday,False
2020-12-26,193,Saturday,True
2020-12-27,187,Sunday,True
2020-12-28,204,Monday,False
2020-12-29,183,Tuesday,False
2020-12-30,159,Wednesday,False
2020-12-31,186,Thursday,False
2021-01-01,156,Friday,False
2021-01-02,175,Saturday,True
2021-01-03,180,Sunday,True
2021-01-04,186,Monday,False
2021-01-05,168,Tuesday,False
2021-01-06,161,Wednesday,False
2021-01-07,136,Thursday,False
2021-01-08,156,Friday,False
2021-01-09,139,Saturday,True
2021-01-10,140,Sunday,True
2021-01-11,188,Monday,False
2021-01-12,163,Tuesday,False
2021-01-13,183,Wednesday,False
2021-01-14,168,Thursday,False
2021-01-15,194,Friday,False
2021-01-16,169,Saturday,True
2021-01-17,154,Sunday,True
2021-01-18,206,Monday,False
2021-01-19,155,Tuesday,False
2021-01-20,187,Wednesday,False
2021-01-21,164,Thursday,False
2021-01-22,161,Friday,False
2021-01-23,156,Saturday,True
2021-01-24,157,Sunday,True
2021-01-25,222,Monday,False
2021-01-26,176,Tuesday,False
2021-01-27,171,Wednesday,False
2021-01-28,187,Thursday,False
2021-01-29,191,Friday,False
2021-01-30,177,Saturday,True
2021-01-31,157,Sunday,True
2021-02-01,177,Monday,False
2021-02-02,171,Tuesday,False
2021-02-03,172,Wednesday,False
2021-02-04,201,Thursday,False
2021-02-05,187,Friday,False
2021-02-06,172,Saturday,True
2021-02-07,171,Sunday,True
2021-02-08,213,Monday,False
2021-02-09,178,Tuesday,False
2021-02-10,164,Wednesday,False
2021-02-11,154,Thursday,False
2021-02-12,134,Friday,False
2021-02-13,186,Saturday,True
2021-02-14,200,Sunday,True
2021-12-03,207,Friday,False
2021-12-04,186,Saturday,True
2021-12-05,188,Sunday,True
2021-12-06,227,Monday,False
2021-12-07,211,Tuesday,False
2021-12-08,235,Wednesday,False
2021-12-09,207,Thursday,False
2021-12-10,198,Friday,False
2021-12-11,193,Saturday,True
2021-12-12,203,Sunday,True
2021-12-13,218,Monday,False
2021-12-14,245,Tuesday,False
2021-12-15,221,Wednesday,False
2021-12-16,216,Thursday,False
2021-12-17,188,Friday,False
2021-12-18,195,Saturday,True
2021-12-19,206,Sunday,True
2021-12-20,212,Monday,False
2021-12-21,176,Tuesday,False
2021-12-22,196,Wednesday,False
2021-12-23,211,Thursday,False
2021-12-24,191,Friday,False
2021-12-25,174,Saturday,True
2021-12-26,171,Sunday,True
2021-12-27,178,Monday,False
2021-12-28,212,Tuesday,False
2021-12-29,235,Wednesday,False
2021-12-30,198,Thursday,False
2021-12-31,190,Friday,False
2022-01-01,182,Saturday,True
2022-01-02,221,Sunday,True
2022-01-03,241,Monday,False
2022-01-04,223,Tuesday,False
2022-01-05,191,Wednesday,False
2022-01-06,225,Thursday,False
2022-01-07,203,Friday,False
2022-01-08,183,Saturday,True
2022-01-09,185,Sunday,True
2022-01-10,228,Monday,False
2022-01-11,203,Tuesday,False
2022-01-12,177,Wednesday,False
2022-01-13,181,Thursday,False
2022-01-14,210,Friday,False
2022-01-15,188,Saturday,True
2022-01-16,158,Sunday,True
2022-01-17,222,Monday,False
2022-01-18,189,Tuesday,False
2022-01-19,171,Wednesday,False
2022-01-20,215,Thursday,False
2022-01-21,220,Friday,False
2022-01-22,155,Saturday,True
2022-01-23,163,Sunday,True
2022-01-24,209,Monday,False
2022-01-25,186,Tuesday,False
2022-01-26,192,Wednesday,False
2022-01-27,182,Thursday,False
2022-01-28,197,Friday,False
2022-01-29,176,Saturday,True
2022-01-30,159,Sunday,True
2022-01-31,152,Monday,False
2022-02-01,179,Tuesday,False
2022-02-02,186,Wednesday,False
2022-02-03,178,Thursday,False
2022-02-04,136,Friday,False
2022-02-05,161,Saturday,True
2022-02-06,147,Sunday,True
2022-02-07,157,Monday,False
2022-02-08,111,Tuesday,False
2022-02-09,141,Wednesday,False
2022-02-10,169,Thursday,False
2022-02-11,147,Friday,False
2022-02-12,166,Saturday,True
2022-02-13,152,Sunday,True
2022-02-14,173,Monday,False
2022-12-03,262,Saturday,True
2022-12-04,301,Sunday,True
2023-12-05,251,Tuesday,False
2023-12-06,233,Wednesday,False
2023-12-07,245,Thursday,False
2023-12-08,260,Friday,False
2023-12-09,250,Saturday,True
2023-12-10,274,Sunday,True
2023-12-11,280,Monday,False
2023-12-12,259,Tuesday,False
2023-12-13,259,Wednesday,False
2023-12-14,285,Thursday,False
2023-12-15,284,Friday,False
2023-12-16,189,Saturday,True
2023-12-17,218,Sunday,True
2023-12-18,261,Monday,False
2023-12-19,264,Tuesday,False
2023-12-20,205,Wednesday,False
2023-12-21,197,Thursday,False
2023-12-22,201,Friday,False
2023-12-23,257,Saturday,True
2023-12-24,224,Sunday,True
2023-12-25,239,Monday,False
2023-12-26,288,Tuesday,False
2023-12-27,293,Wednesday,False
2023-12-28,252,Thursday,False
2023-12-29,275,Friday,False
2023-12-30,273,Saturday,True
2023-12-31,286,Sunday,True
2024-01-01,251,Monday,False
2024-01-02,333,Tuesday,False
2024-01-03,276,Wednesday,False
2024-01-04,264,Thursday,False
2024-01-05,283,Friday,False
2024-01-06,222,Saturday,True
2024-01-07,272,Sunday,True
2024-01-08,330,Monday,False
2024-01-09,282,Tuesday,False
2024-01-10,245,Wednesday,False
2024-01-11,250,Thursday,False
2024-01-12,235,Friday,False
2024-01-13,224,Saturday,True
2024-01-14,230,Sunday,True
2024-01-15,287,Monday,False
2024-01-16,223,Tuesday,False
2024-01-17,244,Wednesday,False
2024-01-18,210,Thursday,False
2024-01-19,281,Friday,False
2024-01-20,223,Saturday,True
2024-01-21,237,Sunday,True
2024-01-22,263,Monday,False
2024-01-23,213,Tuesday,False
2024-01-24,223,Wednesday,False
2024-01-25,244,Thursday,False
2024-01-26,221,Friday,False
2024-01-27,219,Saturday,True
2024-01-28,239,Sunday,True
2024-01-29,275,Monday,False
2024-01-30,241,Tuesday,False
2024-01-31,248,Wednesday,False
2024-02-01,261,Thursday,False
2024-02-02,268,Friday,False
2024-02-03,224,Saturday,True
2024-02-04,279,Sunday,True
2024-02-05,310,Monday,False
2024-02-06,237,Tuesday,False
2024-02-07,216,Wednesday,False
2024-02-08,213,Thursday,False
2024-02-09,181,Friday,False
2024-02-10,168,Saturday,True
2024-02-11,261,Sunday,True
2024-02-12,279,Monday,False
2024-02-13,279,Tuesday,False
2024-02-14,299,Wednesday,False
2024-02-15,286,Thursday,False
2024-02-16,249,Friday,False
2024-02-17,243,Saturday,True
2024-02-18,258,Sunday,True
2024-02-19,302,Monday,False
2024-02-20,287,Tuesday,False
2024-02-21,285,Wednesday,False
2024-02-22,256,Thursday,False
2024-02-23,227,Friday,False
2024-02-24,206,Saturday,True
2024-02-25,240,Sunday,True
2024-02-26,290,Monday,False
2024-02-27,270,Tuesday,False
2024-02-28,279,Wednesday,False
2024-02-29,240,Thursday,False
2024-03-01,224,Friday,False
2024-03-02,191,Saturday,True
2024-03-03,231,Sunday,True
2024-03-04,301,Monday,False
2024-03-05,271,Tuesday,False
2024-03-06,272,Wednesday,False
2024-03-07,256,Thursday,False
2024-03-08,275,Friday,False
2024-03-09,214,Saturday,True
2024-03-10,233,Sunday,True
2024-03-11,298,Monday,False
2024-03-12,273,Tuesday,False
2024-03-13,253,Wednesday,False
2024-03-14,272,Thursday,False
2024-03-15,285,Friday,False
2024-03-16,234,Saturday,True
2024-03-17,274,Sunday,True
2024-03-18,278,Monday,False
2024-03-19,275,Tuesday,False
2024-03-20,273,Wednesday,False
2024-03-21,294,Thursday,False
2024-03-22,266,Friday,False
2024-03-23,252,Saturday,True
2024-03-24,258,Sunday,True
2024-03-25,268,Monday,False
2024-03-26,248,Tuesday,False
2024-03-27,234,Wednesday,False
2024-03-28,269,Thursday,False
2024-03-29,247,Friday,False
2024-03-30,251,Saturday,True
2024-03-31,230,Sunday,True
2024-04-01,297,Monday,False
2024-04-02,267,Tuesday,False
2024-04-03,285,Wednesday,False
2024-04-04,257,Thursday,False
2024-04-05,300,Friday,False
2024-04-06,236,Saturday,True
2024-04-07,254,Sunday,True
2024-04-08,271,Monday,False
2024-04-09,279,Tuesday,False
2024-04-10,285,Wednesday,False
2024-04-11,278,Thursday,False
2024-04-12,262,Friday,False
2024-04-13,225,Saturday,True
2024-04-14,275,Sunday,True
2024-04-15,283,Monday,False
2024-04-16,274,Tuesday,False
2024-04-17,262,Wednesday,False
2024-04-18,248,Thursday,False
2024-04-19,294,Friday,False
2024-04-20,231,Saturday,True
2024-04-21,236,Sunday,True
2024-04-22,298,Monday,False
2024-04-23,265,Tuesday,False
2024-04-24,253,Wednesday,False
2024-04-25,272,Thursday,False
2024-04-26,243,Friday,False
2024-04-27,248,Saturday,True
2024-04-28,247,Sunday,True
2024-06-05,248,Wednesday,False
2024-06-06,262,Thursday,False
2024-06-07,231,Friday,False
2024-06-08,184,Saturday,True
2024-06-09,218,Sunday,True
2024-06-10,259,Monday,False
2024-06-11,289,Tuesday,False
2024-06-12,230,Wednesday,False
2024-06-13,262,Thursday,False
2024-06-14,215,Friday,False
2024-06-15,249,Saturday,True
2024-06-16,257,Sunday,True
2024-06-17,303,Monday,False
2024-06-18,268,Tuesday,False
2024-06-19,246,Wednesday,False
2024-06-20,267,Thursday,False
2024-06-21,247,Friday,False
2024-06-22,274,Saturday,True
2024-06-23,223,Sunday,True
2024-06-24,299,Monday,False
2024-06-25,265,Tuesday,False
2024-06-26,288,Wednesday,False
2024-06-27,263,Thursday,False
2024-06-28,264,Friday,False
2024-06-29,230,Saturday,True
2024-06-30,274,Sunday,True
2024-07-01,221,Monday,False
2024-07-02,271,Tuesday,False
2024-07-03,282,Wednesday,False
2024-07-04,256,Thursday,False
2024-07-05,284,Friday,False
2024-07-06,217,Saturday,True
2024-07-07,273,Sunday,True
2024-07-08,284,Monday,False
2024-07-09,271,Tuesday,False
2024-07-10,252,Wednesday,False
2024-07-11,250,Thursday,False
2024-07-12,263,Friday,False
2024-07-13,216,Saturday,True
2024-07-14,237,Sunday,True
2024-07-15,248,Monday,False
2024-07-16,261,Tuesday,False
2024-07-17,230,Wednesday,False
2024-07-18,222,Thursday,False
2024-07-19,255,Friday,False
2024-07-20,245,Saturday,True
2024-07-21,223,Sunday,True
2024-07-22,303,Monday,False
2024-07-23,265,Tuesday,False
2024-07-24,266,Wednesday,False
2024-07-25,244,Thursday,False
2024-07-26,245,Friday,False
2024-07-27,242,Saturday,True
2024-07-28,233,Sunday,True
2024-07-29,266,Monday,False
2024-07-30,266,Tuesday,False
2024-07-31,232,Wednesday,False
2024-08-01,221,Thursday,False
2024-08-02,240,Friday,False
2024-08-03,229,Saturday,True
2024-08-04,253,Sunday,True
2024-08-05,255,Monday,False
2024-08-06,263,Tuesday,False
2024-08-07,217,Wednesday,False
2024-08-08,237,Thursday,False
2024-08-09,263,Friday,False
2024-08-10,201,Saturday,True
2024-08-11,230,Sunday,True
2024-08-12,285,Monday,False
2024-08-13,206,Tuesday,False
2024-08-14,237,Wednesday,False
2024-08-15,239,Thursday,False
2024-08-16,261,Friday,False
2024-08-17,183,Saturday,True
2024-08-18,228,Sunday,True
2024-08-19,253,Monday,False
2024-08-20,272,Tuesday,False
2024-08-21,230,Wednesday,False
2024-08-22,244,Thursday,False
2024-08-23,255,Friday,False
2024-08-24,216,Saturday,True
2024-08-25,233,Sunday,True
2024-08-26,292,Monday,False
2024-08-27,256,Tuesday,False
2024-08-28,228,Wednesday,False
2024-08-29,247,Thursday,False
2024-08-30,244,Friday,False
2024-08-31,218,Saturday,True
2024-09-01,243,Sunday,True
2024-09-02,261,Monday,False
2024-09-03,224,Tuesday,False
2024-09-04,251,Wednesday,False
2024-09-05,206,Thursday,False
2024-09-06,196,Friday,False
2024-09-07,215,Saturday,True
2024-09-08,225,Sunday,True
2024-09-09,289,Monday,False
2024-09-10,255,Tuesday,False
2024-09-11,213,Wednesday,False
2024-09-12,237,Thursday,False
2024-09-13,239,Friday,False
2024-09-14,214,Saturday,True
2024-09-15,230,Sunday,True
2024-09-16,284,Monday,False
2024-09-17,217,Tuesday,False
2024-09-18,245,Wednesday,False
2024-09-19,286,Thursday,False
2024-09-20,285,Friday,False
2024-09-21,221,Saturday,True
2024-09-22,208,Sunday,True
2024-09-23,267,Monday,False
2024-09-24,243,Tuesday,False
2024-09-25,241,Wednesday,False
2024-09-26,254,Thursday,False
2024-09-27,274,Friday,False
2024-09-28,231,Saturday,True
2024-09-29,232,Sunday,True
2024-09-30,281,Monday,False
2024-10-01,250,Tuesday,False
2024-10-02,239,Wednesday,False
2024-10-03,239,Thursday,False
2024-10-04,245,Friday,False
2024-10-05,204,Saturday,True
2024-10-06,240,Sunday,True
2024-10-07,319,Monday,False
2024-10-08,230,Tuesday,False
2024-10-09,258,Wednesday,False
2024-10-10,233,Thursday,False
2024-10-11,240,Friday,False
2024-10-12,215,Saturday,True
2024-10-13,256,Sunday,True
2024-10-14,290,Monday,False
2024-10-15,267,Tuesday,False
2024-10-16,260,Wednesday,False
2024-10-17,233,Thursday,False
2024-10-18,251,Friday,False
2024-10-19,214,Saturday,True
2024-10-20,227,Sunday,True
2024-10-21,276,Monday,False
2024-10-22,264,Tuesday,False
2024-10-23,254,Wednesday,False
2024-10-24,242,Thursday,False
2024-10-25,242,Friday,False
2024-10-26,230,Saturday,True
2024-10-27,216,Sunday,True
2024-10-28,260,Monday,False
2024-10-29,290,Tuesday,False
2024-10-30,237,Wednesday,False
2024-10-31,249,Thursday,False
2024-11-01,236,Friday,False
2024-11-02,213,Saturday,True
2024-11-03,208,Sunday,True
2024-11-04,289,Monday,False
2024-11-05,233,Tuesday,False
2024-11-06,220,Wednesday,False
2024-11-07,252,Thursday,False
2024-11-08,239,Friday,False
2024-11-09,212,Saturday,True
2024-11-10,256,Sunday,True
2024-11-11,270,Monday,False
2024-11-12,271,Tuesday,False
2024-11-13,241,Wednesday,False
2024-11-14,219,Thursday,False
2024-11-15,257,Friday,False
2024-11-16,244,Saturday,True
2024-11-17,223,Sunday,True
2024-11-18,272,Monday,False
2024-11-19,232,Tuesday,False
2024-11-20,196,Wednesday,False
2024-11-21,242,Thursday,False
2024-11-22,241,Friday,False
2024-11-23,220,Saturday,True
2024-11-24,226,Sunday,True
2024-11-25,250,Monday,False
2024-11-26,262,Tuesday,False
2024-11-27,243,Wednesday,False
2024-11-28,241,Thursday,False
2024-11-29,256,Friday,False
2024-11-30,234,Saturday,True
2024-12-01,248,Sunday,True
2024-12-02,280,Monday,False
2024-12-03,269,Tuesday,False`;

// è§£æCSVæ•¸æ“š
function parseCSVData(csvText) {
    const lines = csvText.trim().split('\n');
    const headers = lines[0].split(',');
    const data = [];
    
    for (let i = 1; i < lines.length; i++) {
        const line = lines[i].trim();
        if (!line) continue;
        
        const values = line.split(',');
        if (values.length < 2) continue;
        
        // ä¿®å¾©æ—¥æœŸæ ¼å¼éŒ¯èª¤ï¼ˆå¦‚ 2024-10-23 å¯«æˆäº† 20244-10-23ï¼‰
        let date = values[0].trim();
        date = date.replace(/^(\d{4})(\d{1})/, '$1'); // ä¿®å¾©å¤šé¤˜çš„å¹´ä»½æ•¸å­—
        
        const attendance = parseInt(values[1].trim(), 10);
        
        if (date && !isNaN(attendance)) {
            data.push({
                date: date,
                patient_count: attendance,
                source: 'historical_analysis_2015_2024',
                notes: `å¾2015-2024å¹´ç¶œåˆåˆ†æå ±å‘Šå°å…¥çš„æ­·å²æ•¸æ“š`
            });
        }
    }
    
    return data;
}

async function importHistoricalData(customDb = null) {
    console.log('ğŸ“Š é–‹å§‹å°å…¥2015-2024å¹´æ­·å²æ•¸æ“š...');
    
    // ä½¿ç”¨å‚³å…¥çš„dbå¯¦ä¾‹ï¼Œæˆ–ä½¿ç”¨é»˜èªçš„
    const dbInstance = customDb || db;
    
    try {
        // ç¢ºä¿æ•¸æ“šåº«å·²åˆå§‹åŒ–ï¼ˆå¦‚æœå°šæœªåˆå§‹åŒ–ï¼‰
        if (!dbInstance.pool) {
            await dbInstance.initDatabase();
        }
        
        // æª¢æŸ¥æ•¸æ“šåº«é€£æ¥
        if (!dbInstance.pool) {
            throw new Error('æ•¸æ“šåº«é€£æ¥æœªåˆå§‹åŒ–');
        }
        
        // è§£æCSVæ•¸æ“š
        const dataToInsert = parseCSVData(CSV_DATA);
        console.log(`âœ… è§£æå®Œæˆï¼Œå…± ${dataToInsert.length} ç­†æ•¸æ“š`);
        
        // æ‰¹é‡æ’å…¥æ•¸æ“š
        const results = await dbInstance.insertBulkActualData(dataToInsert);
        console.log(`âœ… æˆåŠŸå°å…¥ ${results.length} ç­†æ­·å²æ•¸æ“šåˆ°æ•¸æ“šåº«`);
        
        // é¡¯ç¤ºæ•¸æ“šç¯„åœ
        if (dataToInsert.length > 0) {
            const dates = dataToInsert.map(d => d.date).sort();
            console.log(`ğŸ“… æ•¸æ“šç¯„åœ: ${dates[0]} è‡³ ${dates[dates.length - 1]}`);
        }
        
        return results;
    } catch (error) {
        console.error('âŒ å°å…¥æ­·å²æ•¸æ“šå¤±æ•—:', error.message);
        console.error(error.stack);
        throw error;
    }
}

// å¦‚æœç›´æ¥é‹è¡Œæ­¤è…³æœ¬
if (require.main === module) {
    importHistoricalData()
        .then(() => {
            console.log('âœ… å°å…¥å®Œæˆ');
            process.exit(0);
        })
        .catch((error) => {
            console.error('âŒ å°å…¥å¤±æ•—:', error);
            process.exit(1);
        });
}

module.exports = { importHistoricalData, parseCSVData };
