# è‡ªå‹•è¨“ç·´åŠŸèƒ½æŒ‡å—

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

ç³»çµ±ç¾åœ¨æ”¯æŒ**è‡ªå‹•è¨“ç·´**åŠŸèƒ½ï¼šç•¶æœ‰æ–°å¯¦éš›æ•¸æ“šæ›´æ–°æ™‚ï¼Œæœƒè‡ªå‹•æª¢æŸ¥ä¸¦è§¸ç™¼æ¨¡å‹é‡è¨“ç·´ã€‚

## âš™ï¸ å·¥ä½œåŸç†

### è§¸ç™¼æ¢ä»¶

è‡ªå‹•è¨“ç·´æœƒåœ¨ä»¥ä¸‹æ¢ä»¶**å…¨éƒ¨æ»¿è¶³**æ™‚è§¸ç™¼ï¼š

1. **æœ‰æ–°æ•¸æ“š**: è‡³å°‘æœ‰ 7 ç­†æ–°æ•¸æ“šï¼ˆå¯é…ç½®ï¼‰
2. **æ™‚é–“é–“éš”**: è·é›¢ä¸Šæ¬¡è¨“ç·´è‡³å°‘ 1 å¤©ï¼ˆå¯é…ç½®ï¼‰
3. **æœ€å¤§é–“éš”**: å¦‚æœè¶…é 7 å¤©æœªè¨“ç·´ï¼Œå¼·åˆ¶è¨“ç·´ï¼ˆå¯é…ç½®ï¼‰
4. **æœªåœ¨è¨“ç·´**: ç•¶å‰æ²’æœ‰æ­£åœ¨é€²è¡Œçš„è¨“ç·´

### è¨“ç·´æµç¨‹

```
æ–°æ•¸æ“šæ’å…¥
    â†“
æª¢æŸ¥è¨“ç·´æ¢ä»¶
    â†“
æ»¿è¶³æ¢ä»¶ï¼Ÿ
    â”œâ”€ æ˜¯ â†’ å¾Œå°å•Ÿå‹•è¨“ç·´ï¼ˆä¸é˜»å¡ï¼‰
    â””â”€ å¦ â†’ è¨˜éŒ„åŸå› ï¼Œç­‰å¾…ä¸‹æ¬¡
```

## ğŸ”§ é…ç½®é¸é …

### ç’°å¢ƒè®Šæ•¸

```bash
# ç¦ç”¨è‡ªå‹•è¨“ç·´ï¼ˆé»˜èªå•Ÿç”¨ï¼‰
ENABLE_AUTO_TRAIN=false
```

### é…ç½®åƒæ•¸ï¼ˆåœ¨ä»£ç¢¼ä¸­ï¼‰

```javascript
const { getAutoTrainManager } = require('./modules/auto-train-manager');
const trainManager = getAutoTrainManager();

trainManager.updateConfig({
    minDaysSinceLastTrain: 1,      // è‡³å°‘é–“éš” 1 å¤©
    minNewDataRecords: 7,           // è‡³å°‘ 7 ç­†æ–°æ•¸æ“š
    maxTrainingInterval: 7,         // æœ€å¤š 7 å¤©è¨“ç·´ä¸€æ¬¡
    trainingTimeout: 3600000,        // è¨“ç·´è¶…æ™‚ï¼š1 å°æ™‚
    enableAutoTrain: true           // å•Ÿç”¨è‡ªå‹•è¨“ç·´
});
```

## ğŸ“Š API ç«¯é»

### 1. æ‰‹å‹•è§¸ç™¼è¨“ç·´

```bash
POST /api/train-models
```

**éŸ¿æ‡‰**:
```json
{
  "success": true,
  "message": "æ¨¡å‹è¨“ç·´å·²é–‹å§‹ï¼ˆå¾Œå°åŸ·è¡Œï¼‰",
  "status": {
    "isTraining": true,
    "lastTrainingDate": "2025-12-23T10:00:00.000Z",
    "lastDataCount": 1000,
    "config": { ... }
  }
}
```

### 2. ç²å–è¨“ç·´ç‹€æ…‹

```bash
GET /api/training-status
```

**éŸ¿æ‡‰**:
```json
{
  "success": true,
  "data": {
    "isTraining": false,
    "lastTrainingDate": "2025-12-23T10:00:00.000Z",
    "lastDataCount": 1000,
    "config": {
      "minDaysSinceLastTrain": 1,
      "minNewDataRecords": 7,
      "maxTrainingInterval": 7,
      "trainingTimeout": 3600000,
      "enableAutoTrain": true
    }
  }
}
```

### 3. ç²å–é›†æˆæ¨¡å‹ç‹€æ…‹ï¼ˆåŒ…å«è¨“ç·´ä¿¡æ¯ï¼‰

```bash
GET /api/ensemble-status
```

**éŸ¿æ‡‰**:
```json
{
  "success": true,
  "data": {
    "available": true,
    "models": {
      "xgboost": true,
      "lstm": true,
      "prophet": true
    },
    "training": {
      "isTraining": false,
      "lastTrainingDate": "2025-12-23T10:00:00.000Z",
      "lastDataCount": 1000,
      "config": { ... }
    }
  }
}
```

## ğŸ”„ è‡ªå‹•è§¸ç™¼æ™‚æ©Ÿ

è‡ªå‹•è¨“ç·´æœƒåœ¨ä»¥ä¸‹æƒ…æ³è‡ªå‹•è§¸ç™¼ï¼š

1. **API ä¸Šå‚³æ•¸æ“š**: `POST /api/actual-data`
2. **CSV å°å…¥**: `POST /api/import-csv`
3. **æ•¸æ“šåº«ç›´æ¥æ’å…¥**: `database.insertActualData()` æˆ– `insertBulkActualData()`

æ‰€æœ‰è§¸ç™¼éƒ½æ˜¯**ç•°æ­¥åŸ·è¡Œ**ï¼Œä¸æœƒé˜»å¡æ•¸æ“šæ’å…¥æ“ä½œã€‚

## ğŸ“ è¨“ç·´ç‹€æ…‹è¨˜éŒ„

è¨“ç·´ç‹€æ…‹ä¿å­˜åœ¨ï¼š
```
python/models/.training_status.json
```

å…§å®¹ç¤ºä¾‹ï¼š
```json
{
  "lastTrainingDate": "2025-12-23T10:00:00.000Z",
  "lastDataCount": 1000,
  "lastUpdate": "2025-12-23T10:00:00.000Z"
}
```

## ğŸ›ï¸ ä½¿ç”¨ç¤ºä¾‹

### åœ¨ä»£ç¢¼ä¸­æ‰‹å‹•è§¸ç™¼

```javascript
const { getAutoTrainManager } = require('./modules/auto-train-manager');
const trainManager = getAutoTrainManager();

// æ‰‹å‹•è§¸ç™¼è¨“ç·´
const result = await trainManager.manualTrain(db);
console.log('è¨“ç·´çµæœ:', result);
```

### æª¢æŸ¥è¨“ç·´ç‹€æ…‹

```javascript
const status = trainManager.getStatus();
console.log('æ˜¯å¦æ­£åœ¨è¨“ç·´:', status.isTraining);
console.log('ä¸Šæ¬¡è¨“ç·´æ™‚é–“:', status.lastTrainingDate);
```

### æ›´æ–°é…ç½®

```javascript
trainManager.updateConfig({
    minNewDataRecords: 10,  // æ”¹ç‚ºè‡³å°‘ 10 ç­†æ–°æ•¸æ“š
    maxTrainingInterval: 14 // æ”¹ç‚ºæœ€å¤š 14 å¤©è¨“ç·´ä¸€æ¬¡
});
```

## âš ï¸ æ³¨æ„äº‹é …

1. **è¨“ç·´æ™‚é–“**: å®Œæ•´è¨“ç·´éœ€è¦ 15-35 åˆ†é˜ï¼Œåœ¨å¾Œå°åŸ·è¡Œ
2. **è³‡æºæ¶ˆè€—**: è¨“ç·´æœŸé–“æœƒæ¶ˆè€— CPU å’Œå…§å­˜è³‡æº
3. **ä¸é˜»å¡æ“ä½œ**: è¨“ç·´æ˜¯ç•°æ­¥çš„ï¼Œä¸æœƒå½±éŸ¿æ•¸æ“šæ’å…¥
4. **ç¯€æµæ©Ÿåˆ¶**: è‡ªå‹•è¨“ç·´æœ‰ç¯€æµä¿è­·ï¼Œé¿å…é »ç¹è¨“ç·´
5. **è¶…æ™‚ä¿è­·**: è¨“ç·´è¶…é 1 å°æ™‚æœƒè‡ªå‹•çµ‚æ­¢

## ğŸ› æ•…éšœæ’é™¤

### å•é¡Œ 1: è‡ªå‹•è¨“ç·´æœªè§¸ç™¼

**æª¢æŸ¥**:
1. æ˜¯å¦å•Ÿç”¨è‡ªå‹•è¨“ç·´: `ENABLE_AUTO_TRAIN` ç’°å¢ƒè®Šæ•¸
2. æ˜¯å¦æœ‰è¶³å¤ æ–°æ•¸æ“šï¼ˆè‡³å°‘ 7 ç­†ï¼‰
3. è·é›¢ä¸Šæ¬¡è¨“ç·´æ˜¯å¦è‡³å°‘ 1 å¤©
4. æŸ¥çœ‹æ—¥èªŒä¸­çš„è§¸ç™¼åŸå› 

### å•é¡Œ 2: è¨“ç·´å¤±æ•—

**æª¢æŸ¥**:
1. Python ç’°å¢ƒæ˜¯å¦æ­£ç¢ºè¨­ç½®
2. æ‰€æœ‰ä¾è³´æ˜¯å¦å·²å®‰è£: `pip install -r python/requirements.txt`
3. æ•¸æ“šæ˜¯å¦è¶³å¤ ï¼ˆè‡³å°‘ 365 å¤©ï¼‰
4. æŸ¥çœ‹è¨“ç·´æ—¥èªŒè¼¸å‡º

### å•é¡Œ 3: è¨“ç·´è¶…æ™‚

**è§£æ±º**:
- å¢åŠ  `trainingTimeout` é…ç½®
- æª¢æŸ¥ç³»çµ±è³‡æºæ˜¯å¦å……è¶³
- è€ƒæ…®åœ¨ä½å³°æ™‚æ®µè¨“ç·´

## ğŸ“ˆ æœ€ä½³å¯¦è¸

1. **å®šæœŸæª¢æŸ¥**: æ¯é€±æª¢æŸ¥è¨“ç·´ç‹€æ…‹
2. **æ‰‹å‹•è§¸ç™¼**: é‡è¦æ•¸æ“šæ›´æ–°å¾Œå¯æ‰‹å‹•è§¸ç™¼
3. **ç›£æ§è³‡æº**: è¨“ç·´æœŸé–“ç›£æ§ç³»çµ±è³‡æºä½¿ç”¨
4. **æ—¥èªŒæŸ¥çœ‹**: å®šæœŸæŸ¥çœ‹è¨“ç·´æ—¥èªŒäº†è§£è¨“ç·´æƒ…æ³

## ğŸ” æ—¥èªŒç¤ºä¾‹

```
ğŸ“Š æ–°æ•¸æ“šå·²æ’å…¥: 5 ç­†
ğŸ¤– è‡ªå‹•è¨“ç·´è§¸ç™¼: æœ‰ 12 ç­†æ–°æ•¸æ“šï¼Œæ»¿è¶³è¨“ç·´æ¢ä»¶
ğŸš€ é–‹å§‹è‡ªå‹•è¨“ç·´æ¨¡å‹...
   æ™‚é–“: 2025-12-23T10:00:00.000Z
   æ•¸æ“šç¸½æ•¸: 1000
[è¨“ç·´] é–‹å§‹è¨“ç·´ XGBoost...
[è¨“ç·´] XGBoost æ¨¡å‹æ€§èƒ½: MAE: 12.5
[è¨“ç·´] é–‹å§‹è¨“ç·´ LSTM...
[è¨“ç·´] LSTM æ¨¡å‹æ€§èƒ½: MAE: 13.2
[è¨“ç·´] é–‹å§‹è¨“ç·´ Prophet...
[è¨“ç·´] Prophet æ¨¡å‹æ€§èƒ½: MAE: 14.1
âœ… æ¨¡å‹è¨“ç·´å®Œæˆï¼ˆè€—æ™‚ 25.3 åˆ†é˜ï¼‰
```

## âœ… åŠŸèƒ½æ¸…å–®

- [x] è‡ªå‹•æª¢æ¸¬æ–°æ•¸æ“š
- [x] æ™ºèƒ½è§¸ç™¼æ¢ä»¶åˆ¤æ–·
- [x] å¾Œå°ç•°æ­¥è¨“ç·´
- [x] è¨“ç·´ç‹€æ…‹è¨˜éŒ„
- [x] ç¯€æµä¿è­·æ©Ÿåˆ¶
- [x] è¶…æ™‚ä¿è­·
- [x] API ç«¯é»æ”¯æŒ
- [x] é…ç½®éˆæ´»èª¿æ•´

## ğŸ‰ å®Œæˆï¼

è‡ªå‹•è¨“ç·´åŠŸèƒ½å·²å®Œå…¨å¯¦æ–½ã€‚ç³»çµ±ç¾åœ¨æœƒï¼š

1. âœ… è‡ªå‹•æª¢æ¸¬æ–°æ•¸æ“š
2. âœ… æ™ºèƒ½åˆ¤æ–·æ˜¯å¦éœ€è¦è¨“ç·´
3. âœ… å¾Œå°åŸ·è¡Œè¨“ç·´ï¼ˆä¸é˜»å¡ï¼‰
4. âœ… è¨˜éŒ„è¨“ç·´ç‹€æ…‹
5. âœ… æä¾› API æŸ¥è©¢å’Œæ§åˆ¶

äº«å—è‡ªå‹•åŒ–çš„æ¨¡å‹æ›´æ–°ï¼

